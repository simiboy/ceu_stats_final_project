---
title: "Final Project - Draft Analysis"
author:  Blanka Balazs, Simon Fernezelyi, Thea Goslicki
data: "Due 8 January 2022, 23h59"
output:
  bookdown::pdf_document2: default
urlcolor: blue

bibliography: citations.bib
---

**##Potential research question:** To what extent had the implementation of Fox News an effect on the US voting behavior during the presidential elections 1996 & 2000?

# **Introduction**

# Literature Review

In recent decades, there has been increasing attention on the role of media during political campaigns and its effects on the actual outcomes of elections. However, it is still debated within academia to what extent news media influence the behavior of the electorate. A potential answer to the question is that news media does not have an actual effect on people's voting behavior. It is called the sociological model of voting behavior which states that people's voting behavior is determined by long-term factors. This theory is supported by Lazarsfeld, Berelson, and Gaudet's [@Lazarsfeld1968] research analysis whose results show that the effect of media on electoral decisions is minimal but people belonging to different social groups is what determines their voting behavior. Kriesi, Grande, and Lachat [@Kriesi2008] also argue people's voting behavior is determined by their belonging to different cleavages. However, instead of the old cleavages, there is a new social division within society that defines people's voting behavior which is the distinction between the winners and losers of globalization [@Kriesi2008]. Losers of globalization feel that their social status is protected by the nation-state and therefore they are strongly connected and identify themselves with the national community and that is what determines their voting behavior [@Kriesi2008]. In contrast, the winners of globalization benefit from open borders, they have more opportunities and therefore they vote differently [@Kriesi2008] (I wrote this down because maybe we could test if there is any relationship between the number of Fox news subscribers in states that are doing worse economically and those that have developed in the last few decades)

However, other authors argue that issue voting explains voters' party choice which is based on voters' preferences on salient political issues. This theory argues that short-term factors like media attention, campaigns, and current determinant issues in politics determine people's voting behavior. This theory is supported by DeMarzo, Vayanos, and Zwiebel's [@DeMarzo2003] research analysis that persuasion bias (like propaganda, censorship, political spin, and marketing) plays an important role in the process of social opinion formation and as a consequence, it determines people's voting behavior.

# Hypotheses

This paper will follow Lazarsfeld et al.'s (1944) approach and main Hypotheses: The act of voting is an individual act, affected mainly by the personality of the voter and his exposure to the media.In the case of our research and our available data, we categorize the variables about socioeconomic background of the people as personality trades and the exposure to media via the existence or non-existence of Fox News.

**HP1:** Fox news and the socioeconomic background affects the behavior of the electorate.

Sociological model of voting Kriesi's [@Kriesi2008]: People's voting behavior is just shaped by long-term factors (socialization).

**HP2:** Just socioeconomic background affects the behavior of the electorate.

Rational expectation theories [@Bray1987] :Voters often filter out reporting bias without being influenced. The implementation of Fox News will not effect election results.

# Loading Data & General Overview

```{r}
data <- read.csv("foxnews.csv")
data$state <- factor(data$state)
```

In order to have a rough overview of the vote share among states, the *state* variable is converted into a factor variable. Afterwards the average two-party vote share for the Republicans at 2000 Presidential election in the different states is shown in this table in increasing order.

```{r}

gop2000_by_states <- tapply(data$gopvoteshare2000, data$state, mean, na.rm = TRUE)
sort(gop2000_by_states)
```

From these values it is already obvious that there is quite a big variation between the two-party vote share for the Republicans in different states (highest and lowest being Utah (`r max(gop2000_by_states)`) and Rhode Island (`r min(gop2000_by_states)`) respectively).

Afterwards the two-party vote share is calculated for the other two measurement time points as well and the trends are illustrated on a plot below.

```{r}
gop1996_by_states <- tapply(data$gopvoteshare1996, data$state, mean, na.rm = TRUE)
gop1992_by_states <- tapply(data$gopvoteshare1992, data$state, mean, na.rm = TRUE)

# this dataframe contains the mean gop for the three years (1992, 1996, 2000) by state
gop_by_states <- data.frame(gop1992_by_states, gop1996_by_states, gop2000_by_states)

#sort it for easier use
gop_by_states <- gop_by_states[order(gop_by_states$gop2000_by_states), ]

#plot the results
plot(1, type = "n", xlab = "",
     ylab = "Two-party vote share for Republicans",
     main = "Change of two-party vote share for Republicans over time",
     xlim = c(1992, 2003),
     ylim = c(0.3, 0.8))
for(x in 1:nrow(gop_by_states)){
  lines(as.numeric(gop_by_states[x, ]) ~ c(1992, 1996, 2000))
  text(2000.5+((x-1)%%6)/2, gop_by_states$gop2000_by_states[x], row.names(gop_by_states)[x])
}

lines(c(mean(gop1992_by_states, na.rm=T), mean(gop1996_by_states), mean(gop2000_by_states)) ~ c(1992, 1996, 2000),
      lty=2,
      col="red",
      lwd=3)
text(1994, 0.5, "mean", col="red")
```

Obviously this graph is not intended to clearly show the variance of each state, rather the general trends in the different states over time. From this plot it is clear that on average there has been a slight decrease in republican vote share in the period of 1992 and 1996, however there has been differences in different region. For example Main experienced a huge drop while in Idaho a slight increase is visible.

On the other hand in the time period of 1996 and 2000 there has been a strong increase (on average from `r mean(gop1996_by_states)` to `r mean(gop2000_by_states)` ). An important note is that there has been no single state where the republican vote share has decreased in this time period.

Introducing the correlation analysis

```{r}
cor(data[,c(3, 4, 5, 6, 7, 12)])
```

Interpreting the correlation results

```{r}
gop1992_df<- data[ , c("state","town","college1990", "male1990", "black1990", "hisp1990", "income1990","subrf2000", "gopvoteshare1992")]
gop1996_df<- data[ , c("state","town","college1990", "male1990", "black1990", "hisp1990", "income1990","subrf2000", "gopvoteshare1996")]
gop2000_df<- data[ , c("state","town","college1990", "male1990", "black1990", "hisp1990", "income1990","subrf2000", "gopvoteshare2000")]

plot(gop2000_df$gopvoteshare2000, gop2000_df$subrf2000,
     pch = 16, col = "black",cex=0.5,
      xlab = "Two-party vote share for the Republicans (2000 Presidential election)",
      ylab = "Share of Fox News subscribers by town")

```

```{r}
gop_by_s92<- data.frame(gop1992_by_states)
gop_by_s96<- data.frame(gop1996_by_states)
gop_by_s20<- data.frame(gop2000_by_states)


subrf2000_by_states <- tapply(data$subrf2000, data$state, mean, na.rm = TRUE)


# this dataframe contains the mean gop for the three years (1992, 1996, 2000) by state
subrf2000_by_states_df <- data.frame(subrf2000_by_states)


states<- c("Ak","Al","Ar","Ca","Ct","Hi","Ia","Id","Ma","Me","Mi","Mn","Mo","Mt","Nd","Nh","Nj","Ny","Oh","Pa","Ri","Sc","Tn","Ut","Va","Vt","Wi","Wy")


barplot(subrf2000_by_states_df$subrf2000_by_states ~states,
      col="steelblue2",cex.names = 0.4,
      xlab = "State",
      ylab = "Share of Fox News subscribers",
      main= "Share of Fox News subscribers by state in 2000",
      )

```
To get a better picture of the implementation of Fox News in the USA, the share of Fox News subscribers by state in 2000 got plotted. The differences are immense. New Hampshire does not have any access to Fox News in 2000 yet, also in Vermont, Massachusetts and South Carolina is the access ratio to the Fox News Channel almost non existence. On the other hand is the  channel already very accessible in states like New Jersey,Wyoming and Alaska. According to the bar plot has the biggest proportion of Fox News subscribers. However, due to the fact, that the bar plot does not represents the number of Fox News subscribers, only the the proportion of citizens with a subscription per town it does not mean that Hawii does have the highest amount in a quantitative sense. 
```{r}
summary(data$subrf2000, na.rm = T)
towns_w_foxnews<- subset(data, (subset = subrf2000 >= 0.75))
towns_some_foxnews<- subset(data, (subset = subrf2000 > 0  & subrf2000 < 0.75))
towns_no_foxnews<-subset(data, (subset = subrf2000 ==0))

means.all.elections.wFN<-colMeans(towns_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)
means.all.elections.wFN

means.all.elections.someFN<-colMeans(towns_some_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)
means.all.elections.someFN

means.all.elections.noFN<-colMeans(towns_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)
means.all.elections.noFN

years<- c(1992, 1996, 2000)

plot(years, means.all.elections.noFN, pch = 16, col = "black",
xlim = c(1992, 2000), ylim = c(0.4, 0.6), xlab = "Election years",
ylab = "Average vote share for the Republicans ",
main = "Difference in Average vote share across towns with/without fox news")

points(years, means.all.elections.wFN,pch = 16, col = "red")
points(years, means.all.elections.someFN,pch = 16, col = "blue")

abline(v=1996, lty= 2, col= "grey")

lines(years, means.all.elections.noFN, type = "c")
lines(years, means.all.elections.someFN, type = "c", col= "steelblue2")
lines(years, means.all.elections.wFN, type = "c", col="red")

text(1993,0.57, "Towns with Fox News", col="red")
text(1994,0.51, "Towns with some Fox News", col="steelblue2")
text(1993,0.46, "Towns without Fox News")
text(1996, 0.59,"Implementation of Fox News", col="grey")

```
To Test the hypotheses of the research and to measure the effect of the treatment, it is crucial to define the independent variable of the paper: the access to Fox News by the year 2000.As mentioned above Fox News got implemented in 1996. Therefore, the cities without any access to Fox News in 2000 got characterized as 'Towns without Fox News'. Cities who have a share of Fox News subscribers over 0.75 got defines as 'Towns with Fox News', due to the fact, that 75% of the inhabitants is a clear majority, especially when we consider that people live in households with other persons. The data set does not elaborate the information whether children or other people who are not allowed to vote in the states ( like prisoners) are included or not,however a threshold of 0.75 this circumstance cushions instead  a threshold of 1. The third subset will be 'Towns with some Fox News', in particular all towns between the 0 and 0.75 will be part of it.

The graph illustrates that in all cities, no matter how much access to Fox News the various cities had, there was an increase in Republican voters in 2000, compared to the 1996 presidential election. Nevertheless, a staggered effect of the different groups can be seen, even if it is small.Cities with Fox News voted for the Republican president by a larger percentage in both 1996 (the year Fox News was implemented in some cities) and the 2000 presidential election. Cities without any Fox News access were the least likely to vote in favor of Republicans, even though the percentage of Republican voters nevertheless increased in 2000. 

##A Question I would like to do for final assignment

Our hypotheses stating, that it might be possible that socioeconomic backgrouds like education and race of people  influence a potential 'Fox News Effect' differently . It could be also possible that voters with different incomes get effected differently by the input of Fox News.

We will evaluate whether these hypotheses are supported by finding the differences in sample average treatment effects by education, race and income in towns with access to Fox News and towns without access to Fox News.

Furthermore,the average change of votes for republican (during presidential elections) among towns before and after the availability of Fox News could be an crucial indicator to understand the effect, therefore it wil be computed.

```{r}
##SATE town with high proportion of a black population
summary(data$black1990)
high_black_pop.t_w_foxnews<- subset(towns_w_foxnews, subset = black1990 >= 0.4)

high_black_pop.t_no_foxnews<- subset(towns_no_foxnews, subset = black1990 >= 0.4)


means_high_black_pop.t_w_foxnews<-colMeans(high_black_pop.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_high_black_pop.t_no_foxnews<-colMeans(high_black_pop.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_high_black_pop_t_w_fn<-  means_high_black_pop.t_w_foxnews- means_high_black_pop.t_no_foxnews
sate_high_black_pop_t_w_fn



####SATE town with low proportion of a black population

low_black_pop.t_w_foxnews<- subset(towns_w_foxnews, subset = black1990 > 0 & black1990 < 0.4)

low_black_pop.t_no_foxnews<- subset(towns_no_foxnews, subset = black1990 > 0 & black1990 < 0.4)


means_low_black_pop.t_w_foxnews<-colMeans(low_black_pop.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_low_black_pop.t_no_foxnews<-colMeans(low_black_pop.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

sate_low_black_pop_t_w_fn<- means_low_black_pop.t_w_foxnews- means_low_black_pop.t_no_foxnews
sate_low_black_pop_t_w_fn

####SATE town with no proportion of a black population

no_black_pop.t_w_foxnews<- subset(towns_w_foxnews, subset = black1990 == 0)

no_black_pop.t_no_foxnews<- subset(towns_no_foxnews, subset = black1990 == 0)


means_no_black_pop.t_w_foxnews<-colMeans(no_black_pop.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_no_black_pop.t_no_foxnews<-colMeans(no_black_pop.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_no_black_pop_t_w_fn<-means_no_black_pop.t_w_foxnews- means_no_black_pop.t_no_foxnews
sate_no_black_pop_t_w_fn



plot(years,sate_high_black_pop_t_w_fn, pch = 16, col = "aquamarine3",
xlim = c(1992, 2000), ylim = c(-0.15, 0.2), xlab = "Days of presidential election",
ylab = "Estimated sample average fox news effect",
main = "Trends in Fox News Effects among black population")

points(years, sate_low_black_pop_t_w_fn,pch=16, col = "darkseagreen4")
points(years, sate_no_black_pop_t_w_fn,pch = 16, col = "mediumorchid1")


lines(years,sate_high_black_pop_t_w_fn, type="c", col="aquamarine3")
lines(years, sate_low_black_pop_t_w_fn,type="c", col = "darkseagreen4")
lines(years, sate_no_black_pop_t_w_fn,type="c", col = "mediumorchid1")


text(1993, 0.12,"High black Population", col="aquamarine3")
text(1993,0.04,"Low black Population", col="darkseagreen4")
text(1999,0.08, "No black Population", col="mediumorchid1")


```
The first thing we looked at was whether the introduction of Fox News had a bigger/smaller impact on black people in the USA. The cities were divided into subsets, to take into account different proportions of black people in the cities. For the subdivision of cities and their black population, the different quantiles were not looked at, which is the case in the following SATE calculations. Due to the white majority population in the states, the third quantile of the proportion of black people would have been 0.013411 but the maximum would have been 0.990427. The difference between 1% and 99% would have been too serious to categorize all cities in between as having a high black population. That's why cities with a percentage above 0.40 were considered to have a high black population. As can be seen in the plot, only the line from the cities with a high black population share has a similar shape to the lines in the plot with the general trend effect. In the cities with a low proportion or none at all, the estimated treatment effect goes in a negative direction. 
```{r}
##SATE town with high proportion of a black population
summary(data$hisp1990)
high_hisp_pop.t_w_foxnews<- subset(towns_w_foxnews, subset = hisp1990 >= 0.2)

high_hisp_pop.t_no_foxnews<- subset(towns_no_foxnews, subset = hisp1990 >= 0.2)


means_high_hisp_pop.t_w_foxnews<-colMeans(high_hisp_pop.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_high_hisp_pop.t_no_foxnews<-colMeans(high_hisp_pop.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_high_hisp_pop_t_w_fn<-  means_high_hisp_pop.t_w_foxnews- means_high_hisp_pop.t_no_foxnews
sate_high_hisp_pop_t_w_fn



####SATE town with low proportion of a black population

low_hisp_pop.t_w_foxnews<- subset(towns_w_foxnews, subset = hisp1990 > 0 & hisp1990 < 0.4)

low_hisp_pop.t_no_foxnews<- subset(towns_no_foxnews, subset = hisp1990 > 0 & hisp1990 < 0.4)


means_low_hisp_pop.t_w_foxnews<-colMeans(low_hisp_pop.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_low_hisp_pop.t_no_foxnews<-colMeans(low_hisp_pop.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

sate_low_hisp_pop_t_w_fn<- means_low_hisp_pop.t_w_foxnews- means_low_hisp_pop.t_no_foxnews
sate_low_hisp_pop_t_w_fn

####SATE town with no proportion of a black population

no_hisp_pop.t_w_foxnews<- subset(towns_w_foxnews, subset = hisp1990 == 0)

no_hisp_pop.t_no_foxnews<- subset(towns_no_foxnews, subset = hisp1990 == 0)


means_no_hisp_pop.t_w_foxnews<-colMeans(no_hisp_pop.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_no_hisp_pop.t_no_foxnews<-colMeans(no_hisp_pop.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_no_hisp_pop_t_w_fn<-means_no_hisp_pop.t_w_foxnews- means_no_hisp_pop.t_no_foxnews
sate_no_hisp_pop_t_w_fn



plot(years,sate_high_hisp_pop_t_w_fn, pch = 16, col = "aquamarine3",
xlim = c(1992, 2000), ylim = c(-0.15, 0.2), xlab = "Days of presidential election",
ylab = "Estimated sample average fox news effect",
main = "Trends in Fox News Effects among black population")

points(years, sate_low_hisp_pop_t_w_fn,pch=16, col = "darkseagreen4")
points(years, sate_no_hisp_pop_t_w_fn,pch = 16, col = "mediumorchid1")


lines(years,sate_high_hisp_pop_t_w_fn, type="c", col="aquamarine3")
lines(years, sate_low_hisp_pop_t_w_fn,type="c", col = "darkseagreen4")
lines(years, sate_no_hisp_pop_t_w_fn,type="c", col = "mediumorchid1")


text(1998,-0.1,"High Hispanic Population", col="aquamarine3")
text(1993,0.12,"Low Hispanic Population", col="darkseagreen4")
text(1993, 0.04, "No Hispanic Population", col="mediumorchid1")
```

```{r}
summary(data$income1990)

##SATE town with high proportion of rich people

high_income.t_w_foxnews<- subset(towns_w_foxnews, subset = income1990 >= 3.420)
high_income.t_no_foxnews<- subset(towns_no_foxnews, subset = income1990 >= 3.420)

means_high_income.t_w_foxnews<-colMeans(high_income.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_high_income.t_no_foxnews<-colMeans(high_income.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

sate_high_income.t_w_foxnews<-means_high_income.t_w_foxnews- means_high_income.t_no_foxnews
sate_high_income.t_w_foxnews



##SATE town with medium income

medium_income.t_w_foxnews<- subset(towns_w_foxnews, subset = income1990 >1.946 & income1990 <3.420 )
medium_income.t_no_foxnews<- subset(towns_no_foxnews, subset =income1990 >1.946 & income1990 <3.420 )

means_medium_income.t_w_foxnews<-colMeans(medium_income.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_medium_income.t_no_foxnews<-colMeans(medium_income.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_medium_income.t_w_foxnews<-means_medium_income.t_w_foxnews - means_medium_income.t_no_foxnews
sate_medium_income.t_w_foxnews


##SATE town with high proportion of poor people

low_income.t_w_foxnews<- subset(towns_w_foxnews, subset = income1990 <= 1.946)
low_income.t_no_foxnews<- subset(towns_no_foxnews, subset = income1990 <= 1.946)


means_low_income.t_w_foxnews<-colMeans(low_income.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_low_income.t_no_foxnews<-colMeans(low_income.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_low_income.t_w_foxnews<- means_low_income.t_w_foxnews- means_low_income.t_no_foxnews
sate_high_income.t_w_foxnews


plot(years,sate_high_income.t_w_foxnews, pch = 16, col = "green",
xlim = c(1992, 2000), ylim = c(-0.2, 0.2), xlab = "Years of presidential election",
ylab = "Estimated sample average fox news effect",
main = "Trends in Fox News Effects among income")

points(years, sate_medium_income.t_w_foxnews,pch = 16, col = "orange")
points(years, sate_low_income.t_w_foxnews,pch = 16, col = "brown")


lines(years,sate_high_income.t_w_foxnews, type="c", col="green")
lines(years, sate_medium_income.t_w_foxnews,type="c", col = "orange")
lines(years, sate_low_income.t_w_foxnews,type="c", col = "brown")

text(1993,0.13,"High income", col="green")
text(1998,-0.06,"Medium income", col="orange")
text(1998, 0.02, "Low income", col="brown")
```
Looking at income and the potential sample average treatment effect we can see, that only for persons with high income (towns where the average income is over or equals 3.420$) the estimated sample average Fox News effect is increasing and more rich people voted for republicans but an the other hand the vote share for Republicans among rich people normally quite high anyways. Therefore it is hard to argue, that the implementation of Fox News is the main reason. Towns with a medium income or low income have decresing sampel average treatment effect. 
```{r}
summary(data$college1990)

##SATE towns with high proportion of people who went to college

high_edu.t_w_foxnews <- subset(towns_w_foxnews, subset = college1990 >= 0.19255)
high_edu.t_no_foxnews<- subset(towns_no_foxnews, subset = college1990 >= 0.19255)


means_high_edu.t_w_foxnews<-colMeans(high_edu.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_high_edu.t_no_foxnews<-colMeans(high_edu.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_high_edu.t_w_foxnews<- means_high_income.t_no_foxnews -means_high_income.t_w_foxnews
sate_high_edu.t_w_foxnews


##SATE town with medium education

medium_edu.t_w_foxnews<- subset(towns_w_foxnews, subset = college1990 >0.08145 & college1990 <0.19255)
medium_edu.t_no_foxnews<- subset(towns_no_foxnews, subset =college1990 >0.08145 & college1990 <0.19255)
medium_edu.t_some_foxnews<- subset(towns_some_foxnews, subset =college1990 >0.08145 & college1990 <0.19255)

means_medium_edu.t_w_foxnews<-colMeans(medium_edu.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_medium_edu.t_no_foxnews<-colMeans(medium_edu.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_medium_edu.t_w_foxnews<- means_medium_edu.t_w_foxnews - means_medium_edu.t_no_foxnews
sate_medium_edu.t_w_foxnews


##SATE town with high proportion of poor people

low_edu.t_w_foxnews<- subset(towns_w_foxnews, subset = college1990 <= 0.08145)
low_edu.t_no_foxnews<- subset(towns_no_foxnews, subset = college1990 <= 0.08145)


means_low_edu.t_w_foxnews<-colMeans(low_edu.t_w_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)

means_low_edu.t_no_foxnews<-colMeans(low_edu.t_no_foxnews[c('gopvoteshare1992','gopvoteshare1996','gopvoteshare2000')], na.rm = T)


sate_low_edu.t_w_foxnews<- means_low_edu.t_w_foxnews - means_low_edu.t_no_foxnews
sate_high_edu.t_w_foxnews


plot(years,sate_high_edu.t_w_foxnews, pch = 16, col = "darksalmon",
xlim = c(1992, 2000), ylim = c(-0.2, 0.2), xlab = "Years of presidential election",
ylab = "Estimated sample average fox news effect",
main = "Trends in Fox News Effects among the level of education")


points(years, sate_medium_edu.t_w_foxnews,pch = 16, col = "deeppink4")
points(years, sate_low_edu.t_w_foxnews,pch = 16, col = "grey80")


lines(years,sate_high_edu.t_w_foxnews, type="c", col="darksalmon")
lines(years, sate_medium_edu.t_w_foxnews,type="c", col = "deeppink4")
lines(years, sate_low_edu.t_w_foxnews,type="c", col = "grey80")


text(1998,-0.12,"High level of education", col="darksalmon")
text(1998,0.04,"Medium level of education", col="deeppink4")
text(1998, -0.02, "Low level of education", col="grey80")

```
The last measurement of finding the differences in sample average treatment effects by socioeconomic backgrounds is SATE for diffrent levels of education. Here is it visible, that high educated regions are less likely to vote for republicans and have lower starting position. Looking at a medium or low level of education a possible .......
## Regression analysis (Blanka)

We will test H1 (Fox news and the socioeconomic background affects the behavior of the electorate) and H2 (just socioeconomic background affects the behavior of the electorate) through regression analysis. First, we will test to what extent socioeconomic factors affect people's vote for the Republican party. We included in the analysis the proportion of inhabitants who have a college degree, the median income, and the proportion of black or Hispanic people in every city. Black and Hispanic people stand for minorities in the analysis because these are the two most significant minorities and only these two minorities were included in the data set.  


```{r}
#effect of social background

data$hisp_or_black <- data$black1990 + data$hisp1990

socio_economic <- lm(gopvoteshare2000 ~ income1990 + hisp_or_black + college1990, data = data)
socio_economic
summary(socio_economic)$adj.r.squared


```
The results of the analysis show that in cities where the proportion of minorities (Hispanic and Black people) is higher the support for the Republican party is lower than in other cities. Therefore, from the socioeconomic factors that were included in the regression analysis race (`r round(coef( socio_economic )["hisp_or_black"], 4)`) has the strongest effect on support for the Republican party in American cities. The proportion of people who have a college degree is also an important explanatory factor to explain vote for the Republican party in a city. In cities where the proportion of those who have a college degree is higher citizens `r round(coef( socio_economic )["college1990"], 5)` are less likely to vote for the Republican party. Moreover, the median income in cities does not seem to have an effect on support for the Republican party. 

In the following, we will test the influence of Fox News subscribers (in cities) on people's support for the Republican party. Furthermore, the proportion of Fox News subscribers will be added to the socio-economic factors to check what explains better people's vote for the Republican party. 

```{r}

foxnews_2000 <- lm(gopvoteshare2000 ~ subrf2000, data = data)
foxnews_2000
summary(foxnews_2000)$adj.r.squared


socio_foxnews <- lm(gopvoteshare2000 ~ income1990 + hisp_or_black + college1990 + subrf2000, data = data)
socio_foxnews
summary(socio_foxnews)$adj.r.squared

```

The analysis shows that there is no real correlation (`r round(coef( foxnews_2000 )["subrf2000"], 3)`) between Fox News subscribers and the support for the Republican party. Therefore, the proportion of Fox News subscribers does not explain citizens' support for the Republican party. Furthermore, when the proportion of Fox News subscribers was added to the regression the influence of Fox News subscribers on people's support for the republican party became even weaker which means that socioeconomic factors better explain their support for the Republican party than Fox News subscribers. 

However, the results can be misleading because there are much more towns in the data set where there is no access to Fox News or it is very limited. The over representation of these cities can have an effect on the results. Therefore, we created two sub groups. The first group includes cities where more than half of the inhabitants have access to Fox News and the second group includes those towns where less than the half of the population have access to Fox news. 


```{r}

foxnews_present <- subset(data, (subset = subrf2000 >= 0.5))
foxnews_not_present <- subset(data, (subset = subrf2000 < 0.5))

foxnews_present_effect <- lm(gopvoteshare2000 ~ subrf2000, data = foxnews_present)
foxnews_present_effect

foxnews_not_present_effect <- lm(gopvoteshare2000 ~ subrf2000, data = foxnews_not_present)
foxnews_not_present_effect

```
The regression analysis shows that the effect of access to Fox News is still very marginal `r round(coef( foxnews_present_effect )["subrf2000"], 3)`. In cities where more than half of the population have access to Fox News people are more likely to support the republican party compare to those towns where less than half of the population have access to Fox News. 


## Prediction

```{r}

#income

#predictions in 2000
fit_income <- lm(gopvoteshare2000 ~ income1990, data = data)

fit_income_max <- predict(fit_income, data.frame(income1990 = 15))
fit_income_min <- predict(fit_income, data.frame(income1990 = 0))
fun_income <- fit_income_max - fit_income_min

#normalize to [0, 1] sclae

fun_income <- fun_income * 15

#black population
fit_black_1990 <- lm(gopvoteshare2000 ~ black1990, data = data)
fit_black_max <- predict(fit_black_1990, data.frame(black1990 = 1))
fit_black_min <- predict(fit_black_1990, data.frame(black1990 = 0))
fun_black_1990 <- fit_black_max - fit_black_min

#hispanic population
fit_hisp_1990 <- lm(gopvoteshare2000 ~ hisp1990, data = data)
fit_hisp_max <- predict(fit_hisp_1990, data.frame(hisp1990 = 1))
fit_hisp_min <- predict(fit_hisp_1990, data.frame(hisp1990 = 0))
fun_hisp_1990 <- fit_hisp_max - fit_hisp_min

#education level
fit_college_1990 <- lm(gopvoteshare2000 ~ college1990, data = data)
fit_college_max <- predict(fit_college_1990, data.frame(college1990 = 1))
fit_college_min <- predict(fit_college_1990, data.frame(college1990 = 0))
fun_college_1990 <- fit_college_max - fit_college_min

plot(1,
type = "n",
  xlim = c(0, 1),
  ylim = c(0,1),
  main = "Predicted effect of different socio-cultural factors on vote share",
  xlab="Low-High dimension",
  ylab="Predicted two-party vote share for Republicans")

abline(a= fit_income_min,
  b= fun_income,
  col= "orangered",
  )
abline(a= fit_black_min,
  b= fun_black_1990,
  col= "steelblue",
  )
abline(a= fit_hisp_min,
  b= fun_hisp_1990,
  col= "brown",
  )
abline(a= fit_college_min,
  b= fun_college_1990,
  col= "darkgreen",
  )

text(0.8, 0.8,
     "income",
     col="orangered")
text(0.8, 0.6,
     "education level",
     col="darkgreen")
text(0.8, 0.35,
     "black population",
     col="steelblue")
text(0.5, 0.2,
     "hispanic population",
     col="brown")

```

# Conclusion

\newpage

# References
